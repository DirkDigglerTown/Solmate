<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solmate</title>
  <link rel="manifest" href="/manifest.webmanifest">
  <link rel="apple-touch-icon" href="/assets/logo/solmatelogo.png">
  <link rel="icon" href="/assets/logo/solmatelogo.png">
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <header class="hud">
    <div class="left">
      <!-- Removed theme toggle, WS status, and TPS -->
    </div>
    <div class="pill sol" id="solPrice">
      SOL â€”
    </div>
    <!-- Removed TPS display -->
  </header>
  <canvas id="vrmCanvas"></canvas>
  
  <!-- VRM Test Controls -->
  <div id="vrmTestControls" style="
    position: fixed;
    top: 80px;
    left: 20px;
    background: rgba(0, 0, 0, 0.8);
    padding: 15px;
    border-radius: 8px;
    color: white;
    font-family: Arial, sans-serif;
    font-size: 12px;
    z-index: 1000;
    max-width: 200px;
    display: none;
  ">
    <h3 style="margin: 0 0 10px 0; color: #4a90e2;">ğŸ­ VRM Controls</h3>
    
    <div style="margin-bottom: 10px;">
      <button onclick="testTTS()" style="
        background: #00ff88;
        color: black;
        border: none;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
        width: 100%;
        margin-bottom: 5px;
      ">ğŸ¤ Test Voice</button>
      
      <button onclick="fixTPose()" style="
        background: #ff6b6b;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
        width: 100%;
        margin-bottom: 5px;
      ">ğŸ”§ Fix T-Pose</button>
      
      <button onclick="testAnimations()" style="
        background: #4a90e2;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
        width: 100%;
        margin-bottom: 5px;
      ">ğŸ˜Š Test Expressions</button>
      
      <button onclick="startTalking()" style="
        background: #ffa500;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
        width: 100%;
        margin-bottom: 5px;
      ">ğŸ—£ï¸ Test Talking</button>
      
      <button onclick="patchReloadVRMTextures()" style="
        background: #9b59b6;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
        width: 100%;
        margin-bottom: 5px;
      ">ğŸ¨ Fix Textures</button>
      
      <button onclick="patchDiagnoseVRM()" style="
        background: #34495e;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
        width: 100%;
        margin-bottom: 5px;
      ">ğŸ” Diagnose</button>
    </div>
    
    <div style="font-size: 10px; color: #888;">
      Click any button to test Solmate's features
    </div>
  </div>

  <!-- Toggle button for VRM controls -->
  <button id="vrmToggleControls" onclick="toggleVRMControls()" style="
    position: fixed;
    top: 80px;
    left: 20px;
    background: #4a90e2;
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 50%;
    cursor: pointer;
    z-index: 1001;
    font-size: 16px;
  ">ğŸ­</button>
  
  <div id="chatContainer" class="dock">
    <form id="chatForm">
      <input id="promptInput" type="text" class="ask" placeholder="Ask anything about Solana, crypto, or just vibe...">
      <select id="voiceSelect" class="sel">
        <option value="verse">Verse</option>
        <option value="alloy">Alloy</option>
        <option value="aria">Aria</option>
        <option value="echo">Echo</option>
        <option value="fable">Fable</option>
        <option value="onyx">Onyx</option>
        <option value="nova">Nova</option>
        <option value="shimmer">Shimmer</option>
      </select>
      <button id="sendBtn" class="send icon-btn">â–¶</button>
      <button id="clearBtn" class="send icon-btn">ğŸ”‡</button>
    </form>
  </div>
  
  <div id="debugOverlay" class="overlay hidden">
    <h3>Debug</h3>
    <ul>
      <li>Press Ctrl+D to toggle logs overlay</li>
      <li>Check browser console for detailed errors</li>
      <li>VRM file should be ~21MB</li>
      <li>Verify /api/health endpoint</li>
      <li>OpenAI key must be set in Vercel env</li>
    </ul>
    <div id="overlayLogs"></div>
  </div>
  
  <!-- Loading indicator -->
  <div id="loadingStatus" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-family: Arial, sans-serif; z-index: 1000;">
    Initializing Solmate...
  </div>
  
  <script>
    // VRM Controls JavaScript
    function toggleVRMControls() {
      const controls = document.getElementById('vrmTestControls');
      const toggle = document.getElementById('vrmToggleControls');
      
      if (controls.style.display === 'none') {
        controls.style.display = 'block';
        toggle.textContent = 'âŒ';
      } else {
        controls.style.display = 'none';
        toggle.textContent = 'ğŸ­';
      }
    }

    // Auto-show controls when VRM loads
    setTimeout(() => {
      if (typeof scene !== 'undefined' && scene?.getObjectByName?.('VRM_Model')) {
        document.getElementById('vrmTestControls').style.display = 'block';
        document.getElementById('vrmToggleControls').textContent = 'âŒ';
      }
    }, 5000);
    
    // Check periodically for VRM model
    const checkForVRM = setInterval(() => {
      if (typeof scene !== 'undefined' && scene?.getObjectByName?.('VRM_Model')) {
        document.getElementById('vrmTestControls').style.display = 'block';
        document.getElementById('vrmToggleControls').textContent = 'âŒ';
        clearInterval(checkForVRM);
      }
    }, 2000);
  </script>
  
  <script src="/script.js"></script>
</body>
</html>
